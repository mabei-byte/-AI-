# 医疗AI对话提示词优化：实现连续照护与常识推断

## 问题背景

在构建医疗AI对话系统时，我们遇到了一个关键挑战：如何让AI在复杂、动态的真实医疗场景中，表现得像一位经验丰富的真人照护师？特别突出的问题是：

1. **信息不一致的处理**：历史对话、当前陈述与系统结构化数据（如处方）经常存在差异
2. **对话连续性维护**：如何在多轮对话中保持对患者情况的"记忆"和认知一致性
3. **现实常识推理**：如何基于医疗实践常识而非完美数据假设进行推理

典型案例：历史对话中照护师提到了患者使用胰岛素，但系统处方记录中并无胰岛素。优化前，AI会基于系统数据指出矛盾，导致对话出现认知断层，让患者感到困惑（"你刚才不是知道吗？"）。

## 优化目标

让AI具备真人照护师的三种核心能力：
1. **基于医疗共识推理的能力**：理解治疗方案的动态性和数据滞后性
2. **强记忆继承的能力**：在多轮对话中记住并继承已建立的共识
3. **避免认知断裂的能力**：保持对话的连续性和熟悉感

## 优化过程

### 第一阶段：问题识别与分析

通过对实际对话案例的分析，发现了几个关键问题：

1. **简单原则不够用**：原有的"对话连续性与去冗余原则"过于抽象，模型无法理解如何在实际复杂场景中应用
2. **信息优先级不明确**：当历史对话、当前陈述和系统数据冲突时，模型没有明确的决策框架
3. **缺乏现实常识**：模型不理解真实医疗场景中处方滞后、患者自行调整等常见现象

### 第二阶段：原则重构

将原有的抽象原则重构为具体的、可操作的"现实世界常识推断与强记忆继承原则"，包含三个子原则：

#### 5.1 医疗共识的推断与继承
- **原因推断机制**：明确指导模型如何理解历史对话中的治疗信息
- **冲突处理准则**：建立信息优先级（当前陈述 > 历史共识 > 系统数据）
- **安全边界**：只在涉及医疗安全红线时才进行确认

#### 5.2 场景信息的保守回应
- **禁止猜测输出**：防止模型将自身推断作为事实输出
- **包容性语言**：指导模型使用中立、关怀的表达方式
- **具体示例**：提供正反面示例，明确期望的行为

#### 5.3 统一要求：强记忆继承
- **认知连续性**：要求模型表现出对患者情况的了解
- **避免认知断裂**：禁止表现出困惑、质疑或"失忆"

### 第三阶段：思考框架对齐

在CoT思考过程中明确整合新原则的应用：

1. **识别阶段**：要求模型主动检查历史共识
2. **分析判断阶段**：明确调用具体原则进行决策
3. **输出阶段**：确保回复自然、连续、无结构化痕迹

### 第四阶段：案例验证与迭代

使用原有翻车案例进行验证，发现模型现在能够：

1. ✅ 正确继承历史对话中关于胰岛素使用的共识
2. ✅ 忽略系统处方的不一致，基于常识推断继续对话
3. ✅ 使用保守、包容的语言回应场景信息
4. ✅ 思考过程中明确应用新原则进行推理
5. ✅ 输出与真人照护师几乎一致的回复

## 关键优化技巧

### 1. 从抽象到具体
**之前**："已达成共识的信息，后续对话默认继承"
**之后**：详细的三步推理过程 + 冲突处理准则 + 具体示例

### 2. 提供可操作的决策框架
- 建立明确的信息优先级
- 区分"安全关键"和"非安全关键"场景
- 提供具体的话术模式

### 3. 嵌入现实常识
- 明确告知模型"处方滞后是常态"
- 解释常见不一致的原因（医院间未同步、患者微调等）
- 建立"历史共识反映现实"的默认认知

### 4. 结构化思考引导
在CoT框架中明确要求模型检查和应用具体原则，确保原则被实际使用。

### 5. 正反示例对比
提供清晰的错误示例和正确示例，帮助模型理解期望的行为边界。

## 优化后的提示词结构

```
### 思考核心原则
1. 禁止前置负面假设
2. 以临床推理为依据
3. 澄清的目的与最小原则
4. 克制干预，回应意图
5. 现实世界常识推断与强记忆继承原则
   5.1 医疗共识的推断与继承
   5.2 场景信息的保守回应
   5.3 统一要求：强记忆继承
6. 时效性处理策略
7. 赋能原则
8. "行为前"指导原则
```

## 效果评估

优化后，模型在以下方面显著提升：

1. **对话连续性**：不再出现"记忆断层"，患者感觉在与"了解自己"的照护师对话
2. **专业判断**：基于现实常识而非完美数据假设进行医疗推理
3. **用户信任**：避免因信息不一致造成的困惑和质疑
4. **安全边界**：在保持连续性的同时，关键安全点得到妥善处理

## 经验总结

### 成功的核心要素

1. **理解真实工作流程**：提示词设计需要基于对真实医疗场景的深入理解
2. **原则具体化**：抽象原则必须转化为具体的推理步骤和行为准则
3. **提供决策框架**：给模型明确的判断标准和优先级
4. **现实常识教育**：需要明确告知模型真实世界的复杂性和数据局限性
5. **持续案例验证**：用实际案例测试和迭代提示词效果

### 对医疗AI提示词设计的建议

1. **不要假设模型理解行业常识**：需要明确告诉模型行业的特定工作模式
2. **重视对话历史的作用**：在医疗场景中，对话历史往往比结构化数据更反映现实
3. **平衡连续性与安全性**：在保持对话流畅的同时，确保医疗安全底线
4. **提供具体的话术指导**：模型需要知道"怎么说"而不仅仅是"说什么"
5. **设计可验证的测试案例**：用典型场景验证提示词效果

## 结论

通过这次优化，我们成功地将真人照护师的隐性知识——对信息不一致的常识处理、对话连续性的维护、基于现实的推理判断——转化为了AI可理解、可执行的显性指令。这不仅解决了具体的技术问题，更重要的是建立了一种将领域专家知识有效编码到AI系统的方法论。

医疗AI的成功不仅在于医学知识的准确性，更在于对医疗工作流程、医患互动模式、现实数据局限性的深入理解。好的提示词设计是连接技术能力与领域需求的桥梁，需要持续迭代、验证和优化。

这一经验对于其他需要处理复杂现实场景、维护长期关系、基于不完美数据决策的对话系统也具有重要的参考价值。
